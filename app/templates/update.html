{% extends 'base.html' %}

{% block head %}
<title>Watching History</title>
{% endblock %}

{% block body %}
    <h1 style="text-align: center;">Updating History</h1>

    <div class="form">
        <form action="/update/{{history.id}}" method="POST">
            <label for="title">Title:</label>
            <input type="text" name="title" value="{{history.title}}" required><br>

            <label for="season">Season:</label>
            <select name="season" id="seasonSelect">
                {% for season_option in ['季', '卷', '無'] %}
                    {% if history.season == season_option %}
                        <option value="{{ season_option }}" selected>{{ season_option }}</option>
                    {% else %}
                        <option value="{{ season_option }}">{{ season_option }}</option>
                    {% endif %}
                {% endfor %}
            </select><br>

            <label for="value" id="valueLabel">Value:</label>
            <input type="number" name="value" value="{{history.value}}" id="valueInput" required><br>

            <label for="episode">Episode:</label>
            <input type="number" name="episode" value="{{history.episode}}" required><br>

            <label for="progress">Progress:</label>
            <input type="text" name="progress" value="{{history.progress}}" required><br>

            <input type="submit" value="更新">
        </form>
    </div>

    <script>
        const seasonSelect = document.getElementById('seasonSelect');
        const valueLabel = document.getElementById('valueLabel');
        const valueInput = document.getElementById('valueInput');
        const episodeInput = document.getElementById('episodeInput');
    
        seasonSelect.addEventListener('change', function() {
            if (seasonSelect.value === '無') {
                valueLabel.style.visibility = 'hidden'; // Hide the label
                valueInput.style.visibility = 'hidden'; // Hide the input
            } else {
                valueLabel.style.visibility = 'visible'; // Show the label
                valueInput.style.visibility = 'visible'; // Show the input
            }
        });
    
        // Trigger the change event initially in case there's a default value selected
        seasonSelect.dispatchEvent(new Event('change'));
    </script>
{% endblock %}